# EXPERIMENT CONFIGURATION - Full parameter sweep experiments
#
# This configuration allows you to set prompts in the YAML file.
# The prompts' keys are abbreviations that can be used for naming files,
# and their values are the actual prompts for text-to-3D generation.
#
# USAGE:
# sbatch scripts/run_ours_exp.sh exp_repulsion_lambda_sweep

exp0_baseline:
  name: exp0_baseline
  method: grid
  sweep_parameters:
    prompt: 
      hamburger: "a photo of a hamburger"
      icecream: "a photo of an ice cream"
      saguaro: "a small saguaro cactus planted in a clay pot"
      tulip: "a photo of a tulip"
  # fixed parameters
  fixed_parameters:
    repulsion_type: 'wo'
    seed: 42
    num_particles: 8
    feature_layer: 6
    iters: 1500
    invert_bg_prob: 0.0 # always white background

  settings:
    # visualize
    visualize: True
    save_iid: False
    save_rendered_images: True
    save_rendered_images_interval: 100
    save_multi_viewpoints: True
    save_multi_viewpoints_interval: 500

    eval_W: 256
    eval_H: 256
    
    # metrics
    metrics: True
    quantitative_metrics_interval: 50
    losses_interval: 10
    efficiency_interval: 10 
    num_views: 8
    enable_lpips: False # disable lpips for faster training

# Experiment 1: Repulsion lambda sweep with multiple prompts

exp1_1_lambda_debug:
  name: exp1_1_lambda_debug
  method: grid
  sweep_parameters:
    prompt: 
      hamburger: "a photo of a hamburger"
      # icecream: "a photo of an ice cream"
      # saguaro: "a small saguaro cactus planted in a clay pot"
      # tulip: "a photo of a tulip"
    repulsion_type: ['rlsd', 'svgd']
    kernel_type: ['cosine', 'rbf']
    lambda_repulsion:
      rlsd_cosine: [1000]
      svgd_cosine: [1000]
      rlsd_rbf: [1000]
      svgd_rbf: [1000]
    
  fixed_parameters:
    seed: 42
    num_particles: 8
    feature_extractor_model_name: "facebook/dinov2-base"
    feature_layer: 6
    kernel_tau: 0.5 # only for rbf
    iters: 300
    use_sigma_weight: True
    rep_sigma_power: 0.5
    use_cosine_decay: True
    rep_cosine_warmup: 0.2
    invert_bg_prob: 0.0 # always white background

  settings:
    # visualize
    visualize: True
    save_iid: False
    save_rendered_images: True
    save_rendered_images_interval: 100
    save_multi_viewpoints: False

    eval_W: 256
    eval_H: 256
    
    # metrics
    metrics: True
    quantitative_metrics_interval: 50
    losses_interval: 10
    efficiency_interval: 10 
    num_views: 8
    enable_lpips: False # disable lpips for faster training

exp1_2_lambda:
  name: exp1_2_lambda
  method: grid
  sweep_parameters:
    prompt: 
      hamburger: "a photo of a hamburger"
      # icecream: "a photo of an ice cream"
      # saguaro: "a small saguaro cactus planted in a clay pot"
      tulip: "a photo of a tulip"
    repulsion_type: ['rlsd', 'svgd']
    kernel_type: ['cosine', 'rbf']
    lambda_repulsion: # TODO: add more values
      rlsd_cosine: [1000]
      svgd_cosine: [1000]
      rlsd_rbf: [1000]
      svgd_rbf: [1000]
    
  fixed_parameters:
    seed: 42
    num_particles: 8
    feature_extractor_model_name: "facebook/dinov2-base"
    feature_layer: 6
    kernel_tau: 0.5 # only for rbf
    iters: 300 # TODO: change to higher value
    use_sigma_weight: True
    rep_sigma_power: 0.5
    use_cosine_decay: True
    rep_cosine_warmup: 0.2
    invert_bg_prob: 0.0 # always white background

  settings:
    # visualize
    visualize: True
    save_iid: False
    save_rendered_images: True
    save_rendered_images_interval: 100
    save_multi_viewpoints: False

    eval_W: 256
    eval_H: 256
    
    # metrics
    metrics: True
    quantitative_metrics_interval: 50
    losses_interval: 10
    efficiency_interval: 10 
    num_views: 8
    enable_lpips: False # disable lpips for faster training

exp1_3_all_prompts_with_win_lambda:
  name: exp1_3_all_prompts_with_win_lambda
  method: grid
  sweep_parameters:
    prompt: 
      hamburger: "a photo of a hamburger"
      icecream: "a photo of an ice cream"
      saguaro: "a small saguaro cactus planted in a clay pot"
      tulip: "a photo of a tulip"
    repulsion_type: ['rlsd', 'svgd']
    kernel_type: ['cosine', 'rbf']
    
  fixed_parameters:
    seed: 42
    lambda_repulsion: 
      rlsd_rbf: 1000
      rlsd_cosine: 1200
      svgd_rbf: 1400
      svgd_cosine: 1200

    num_particles: 8
    feature_extractor_model_name: "facebook/dinov2-base"
    feature_layer: 6
    kernel_tau: 0.5 # only for rbf
    iters: 1500
    use_sigma_weight: True
    rep_sigma_power: 0.5
    use_cosine_decay: True
    rep_cosine_warmup: 0.2
    invert_bg_prob: 0.0 # always white background

  settings:
    # visualize
    visualize: True
    save_iid: False
    save_rendered_images: True
    save_rendered_images_interval: 200
    save_multi_viewpoints: True
    save_multi_viewpoints_interval: 1000

    eval_W: 256
    eval_H: 256
    
    # metrics
    metrics: True
    quantitative_metrics_interval: 50
    losses_interval: 10
    efficiency_interval: 10 
    num_views: 8
    enable_lpips: False # disable lpips for faster training

# Experiment 2: Kernel type comparison with custom prompts
exp2_kernel:
  name: exp2_kernel
  method: grid
  sweep_parameters:
    seed: [42]
    prompt: 
      hamburger: "a photo of a hamburger"
      icecream: "a photo of an ice cream"
      saguaro: "a small saguaro cactus planted in a clay pot"
      tulip: "a photo of a tulip"
    repulsion_type: ['rlsd', 'svgd']
    kernel_type: ['rbf', 'cosine']

    
  fixed_parameters:
    num_particles: 8
    feature_extractor_model_name: "facebook/dinov2-base"

    lambda_repulsion: 
      rlsd_rbf: 1000
      rlsd_cosine: 1000
      svgd_rbf: 1000
      svgd_cosine: 1000

    feature_layer: 6
    kernel_tau: 0.5 # only for rbf
    iters: 1500
    use_sigma_weight: True
    rep_sigma_power: 0.5
    use_cosine_decay: True
    rep_cosine_warmup: 0.2
    invert_bg_prob: 0.0 # always white background

  settings:
    # visualize
    visualize: True
    save_iid: False
    save_rendered_images: True
    save_rendered_images_interval: 1500
    save_multi_viewpoints: True
    save_multi_viewpoints_interval: 1500

    eval_W: 256
    eval_H: 256
    
    # metrics
    metrics: True
    quantitative_metrics_interval: 50
    losses_interval: 10
    efficiency_interval: 10 
    num_views: 8
    enable_lpips: False # disable lpips for faster training

exp2_kernel:
  name: exp2_kernel
  method: grid
  sweep_parameters:
    repulsion_type: ['svgd', 'rlsd']
    kernel_type: ['rbf', 'cosine']
    prompt: 
      hamburger: "a photo of a hamburger"
      icecream: "a photo of an ice cream"
      saguaro: "a small saguaro cactus planted in a clay pot"
      tulip: "a photo of a tulip"

  fixed_parameters:
    lambda_repulsion: 
      rlsd_rbf: 1000
      rlsd_cosine: 1000
      svgd_rbf: 1000
      svgd_cosine: 1000
    num_particles: 8
    feature_extractor_model_name: "facebook/dinov2-base"

    feature_layer: 6
    kernel_tau: 0.5 # only for rbf
    iters: 1500
    use_sigma_weight: True
    rep_sigma_power: 0.5
    use_cosine_decay: True
    rep_cosine_warmup: 0.2
    invert_bg_prob: 0.0 # always white background

  settings:
    # visualize
    visualize: True
    save_iid: False
    save_rendered_images: True
    save_rendered_images_interval: 1500
    save_multi_viewpoints: True
    save_multi_viewpoints_interval: 1500

    eval_W: 256
    eval_H: 256
    
    # metrics
    metrics: True
    quantitative_metrics_interval: 50
    losses_interval: 10
    efficiency_interval: 10 
    num_views: 8
    enable_lpips: False # disable lpips for faster training

# Experiment 3: Single prompt test with different parameters
exp3_tau:
  name: exp3_tau
  method: grid
  sweep_parameters:
    repulsion_type: ['svgd', 'rlsd']
    
    kernel_tau: [0.5, 1.0, 1.5, 2.0, 2.5, 3.0]

  fixed_parameters:
    seed: 42
    prompt: 
      hamburger: "a photo of a hamburger"
      icecream: "a photo of an ice cream"
      saguaro: "a small saguaro cactus planted in a clay pot"
      tulip: "a photo of a tulip"
    num_particles: [8]
#     feature_extractor_model_name: ["facebook/dinov2-base"]
#     feature_layer: [6]
    
#     kernel_tau: [0.5] # only for rbf
#     iters: [1000]
#     use_sigma_weight: [True]
#     rep_sigma_power: [0.5]
#     use_cosine_decay: [True]
#     rep_cosine_warmup: [0.2]
#     invert_bg_prob: [0.0] # always white background
    
#   settings:
#     # visualize
#     visualize: True
#     save_iid: False
#     save_rendered_images: False
#     save_rendered_images_interval: 100
#     save_multi_viewpoints: False
#     # metrics
#     metrics: True
#     quantitative_metrics_interval: 10
#     losses_interval: 10
#     efficiency_interval: 10 
#     num_views: 8
#     enable_lpips: False # disable lpips for faster training